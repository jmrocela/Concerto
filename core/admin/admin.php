<?php/*! * Concerto 1.0 beta * http://themeconcert.com/concerto * * [WARNING] * This is restricted file and should not be modified in any way(unless you know what * you are doing). This file serves as the Base Class for setting up administration pages. */class ConcertoAdmin {	public function __construct() {		global $extensions;				// Require the individual Administration Pages		require_once CONCERTO_ADM . 'general.php';		require_once CONCERTO_ADM . 'design.php';		require_once CONCERTO_ADM . 'tools.php';		require_once CONCERTO_ADM . 'support.php';				// Hook boxes to their assigned places		require_once CONCERTO_ADM . 'actions.php';				// Load Extensions and Stages		$extensions->load();				// Bind Concerto to Wordpress		add_action('admin_init', array($this, 'init'));		add_action('admin_head', array($this, 'head'));		add_action('admin_menu', array($this, 'menu'));	}		public function init() {		// We Include our Javascript Files		$stylesheet_directory = get_bloginfo('stylesheet_directory');		wp_register_script('jQueryMasonry', $stylesheet_directory . '/core/scripts/jquery.masonry.js', null, CONCERTO_VERSION);		wp_register_script('jQuerySWFUpload', $stylesheet_directory . '/core/scripts/jquery.swfupload.js', null, CONCERTO_VERSION);		wp_enqueue_script('jQueryMasonry');				if (is_plugin_page()) {			if ($_GET['page'] == 'concerto_admin_menu' || $_GET['page'] == 'concerto_admin_design') {				wp_enqueue_script('jquery-ui-sortable', null, array('jquery-ui-core'));				wp_enqueue_script('swfupload');				wp_enqueue_script('jQuerySWFUpload');			}			if ($_GET['page'] == 'concerto_admin_design') {				wp_enqueue_script('farbtastic');				wp_enqueue_style('farbtastic');			}			if ($_GET['page'] == 'concerto_admin_tools') {				require_once 'functions.php';			}		}				// Handle the Uploads for the Favicon, Header Images, Configuration Files and Stage Archives		if (@$_FILES['CONCERTO_UPLOAD']) {			$this->upload();			die();		}				// We Register Options		$this->registerSettings();	}		public function head() {		?>		<!-- Concerto Framework Files -->		<link rel="stylesheet" type="text/css" href="<?php bloginfo('stylesheet_directory'); ?>/core/admin/style.css"/>		<!-- Concerto Framework Files -->		<?php	}		public function menu() {		global $menu;		$menu[99] = array('', 'read', 'separator-concerto', '', 'wp-menu-separator');			add_menu_page(__('General', 'concerto'), __('Concerto', 'concerto'), 'switch_themes', 'concerto_admin_menu', 'admin_general', null, 100);		add_submenu_page('concerto_admin_menu', __('Concerto - General', 'concerto'), __('General', 'concerto'), 'switch_themes', 'concerto_admin_menu', 'admin_general');		add_submenu_page('concerto_admin_menu', __('Concerto - Design', 'concerto'), __('Design', 'concerto'), 'switch_themes', 'concerto_admin_design', 'admin_design');		add_submenu_page('concerto_admin_menu', __('Concerto - Tools', 'concerto'), __('Tools', 'concerto'), 'switch_themes', 'concerto_admin_tools', 'admin_tools');		add_submenu_page('concerto_admin_menu', __('Concerto - Support', 'concerto'), __('Support', 'concerto'), 'switch_themes', 'concerto_admin_support', 'admin_support');	}	public function registerSettings() {		require_once CONCERTO_ADM . 'settings.php';		do_action('concerto_admin_settings');	}	public function upload() {		/* https://github.com/jmrocela/Concerto/issues#issue/1 */		if ($_POST['concerto_action'] == 'favicon' || $_POST['concerto_action'] == 'header') {			$overrides = array( 'test_form' => false);			$file = wp_handle_upload($_FILES['CONCERTO_UPLOAD'], $overrides);			echo $file['url'];		}		die();	}}	function admin_notices() {	?>	<div class="concerto_notice level_green">		You are running an Alpha Version of Concerto. This product is provided free under our <a href="http://themeconcert.com/documents/licenses/free-beta" target="_new"">Terms and Agreements</a>.<br/>		If you experience any bugs, issues or suggestions, don't hesitate to <a href="http://themeconcert.com/members/feedback" target="_new"">give us your feedback</a>.	</div>	<?php}?>